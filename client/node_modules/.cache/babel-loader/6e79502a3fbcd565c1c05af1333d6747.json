{"ast":null,"code":"import _regeneratorRuntime from\"/Users/kevinchen/Desktop/WSU_Fall2020/Web/git-IA/IA7/code-ch23/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/kevinchen/Desktop/WSU_Fall2020/Web/git-IA/IA7/code-ch23/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/kevinchen/Desktop/WSU_Fall2020/Web/git-IA/IA7/code-ch23/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/kevinchen/Desktop/WSU_Fall2020/Web/git-IA/IA7/code-ch23/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/kevinchen/Desktop/WSU_Fall2020/Web/git-IA/IA7/code-ch23/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/kevinchen/Desktop/WSU_Fall2020/Web/git-IA/IA7/code-ch23/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/kevinchen/Desktop/WSU_Fall2020/Web/git-IA/IA7/code-ch23/client/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import NavBar from'./NavBar.js';import SideMenu from'./SideMenu.js';import ModeBar from'./ModeBar.js';import FloatingButton from'./FloatingButton.js';import LoginPage from'./LoginPage.js';import AppMode from\"./../AppMode.js\";import FeedPage from'./FeedPage.js';import Rounds from'./Rounds.js';import CoursesPage from'./CoursesPage.js';var modeTitle={};modeTitle[AppMode.LOGIN]=\"Welcome to SpeedScore\";modeTitle[AppMode.FEED]=\"Activity Feed\";modeTitle[AppMode.ROUNDS]=\"My Rounds\";modeTitle[AppMode.ROUNDS_LOGROUND]=\"Log New Round\";modeTitle[AppMode.ROUNDS_EDITROUND]=\"Edit Round\";modeTitle[AppMode.COURSES]=\"Courses\";var modeToPage={};modeToPage[AppMode.LOGIN]=LoginPage;modeToPage[AppMode.FEED]=FeedPage;modeToPage[AppMode.ROUNDS]=Rounds;modeToPage[AppMode.ROUNDS_LOGROUND]=Rounds;modeToPage[AppMode.ROUNDS_EDITROUND]=Rounds;modeToPage[AppMode.COURSES]=CoursesPage;var App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);function App(){var _this;_classCallCheck(this,App);_this=_possibleConstructorReturn(this,_getPrototypeOf(App).call(this));_this.refreshOnUpdate=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(newMode){var response,obj;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"/users/\"+_this.state.userObj.id);case 2:response=_context.sent;_context.next=5;return response.json();case 5:response=_context.sent;obj=JSON.parse(response);_this.setState({userObj:obj,mode:newMode});case 8:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.handleChangeMode=function(newMode){_this.setState({mode:newMode});};_this.openMenu=function(){_this.setState({menuOpen:true});};_this.closeMenu=function(){_this.setState({menuOpen:false});};_this.toggleMenuOpen=function(){_this.setState(function(prevState){return{menuOpen:!prevState.menuOpen};});};_this.setUserId=function(Id){_this.setState({userId:Id,authenticated:true});};_this.state={mode:AppMode.LOGIN,menuOpen:false,authenticated:false,userObj:{displayName:\"\",profilePicURL:\"\"}};return _this;}//componentDidMount\n_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;if(!this.state.authenticated){//Use /auth/test route to (re)-test authentication and obtain user data\nfetch(\"/auth/test\").then(function(response){return response.json();}).then(function(obj){if(obj.isAuthenticated){_this2.setState({userObj:obj.user,authenticated:true,mode:AppMode.FEED//We're authenticated so can get into the app.\n});}});}}//refreshOnUpdate(newMode) -- Called by child components when user data changes in \n//the database. The function calls the users/:userid (GET) route to update \n//the userObj state var based on the latest database changes, and sets the \n//mode state var is set to newMode. After this method is called, the\n//App will re-render itself, forcing the new data to \n//propagate to the child components when they are re-rendered.\n},{key:\"render\",value:function render(){var _this3=this;var ModePage=modeToPage[this.state.mode];return React.createElement(\"div\",null,React.createElement(NavBar,{title:modeTitle[this.state.mode],mode:this.state.mode,changeMode:this.handleChangeMode,menuOpen:this.state.menuOpen,toggleMenuOpen:this.toggleMenuOpen}),React.createElement(SideMenu,{menuOpen:this.state.menuOpen,mode:this.state.mode,toggleMenuOpen:this.toggleMenuOpen,displayName:this.state.userObj.displayName,profilePicURL:this.state.userObj.profilePicURL,logOut:function logOut(){return _this3.handleChangeMode(AppMode.LOGIN);}}),React.createElement(ModeBar,{mode:this.state.mode,changeMode:this.handleChangeMode,menuOpen:this.state.menuOpen}),React.createElement(ModePage,{menuOpen:this.state.menuOpen,mode:this.state.mode,changeMode:this.handleChangeMode,userObj:this.state.userObj,refreshOnUpdate:this.refreshOnUpdate}));}}]);return App;}(React.Component);export default App;","map":{"version":3,"sources":["/Users/kevinchen/Desktop/WSU_Fall2020/Web/git-IA/IA7/code-ch23/client/src/components/App.js"],"names":["React","NavBar","SideMenu","ModeBar","FloatingButton","LoginPage","AppMode","FeedPage","Rounds","CoursesPage","modeTitle","LOGIN","FEED","ROUNDS","ROUNDS_LOGROUND","ROUNDS_EDITROUND","COURSES","modeToPage","App","refreshOnUpdate","newMode","fetch","state","userObj","id","response","json","obj","JSON","parse","setState","mode","handleChangeMode","openMenu","menuOpen","closeMenu","toggleMenuOpen","prevState","setUserId","Id","userId","authenticated","displayName","profilePicURL","then","isAuthenticated","user","ModePage","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport NavBar from './NavBar.js';\nimport SideMenu from './SideMenu.js';\nimport ModeBar from './ModeBar.js';\nimport FloatingButton from './FloatingButton.js';\nimport LoginPage from './LoginPage.js';\nimport AppMode from \"./../AppMode.js\"\nimport FeedPage from './FeedPage.js';\nimport Rounds from './Rounds.js';\nimport CoursesPage from './CoursesPage.js';\n\nconst modeTitle = {};\nmodeTitle[AppMode.LOGIN] = \"Welcome to SpeedScore\";\nmodeTitle[AppMode.FEED] = \"Activity Feed\";\nmodeTitle[AppMode.ROUNDS] = \"My Rounds\";\nmodeTitle[AppMode.ROUNDS_LOGROUND] = \"Log New Round\";\nmodeTitle[AppMode.ROUNDS_EDITROUND] = \"Edit Round\";\nmodeTitle[AppMode.COURSES] = \"Courses\";\n\nconst modeToPage = {};\nmodeToPage[AppMode.LOGIN] = LoginPage;\nmodeToPage[AppMode.FEED] = FeedPage;\nmodeToPage[AppMode.ROUNDS] = Rounds;\nmodeToPage[AppMode.ROUNDS_LOGROUND] = Rounds;\nmodeToPage[AppMode.ROUNDS_EDITROUND] = Rounds;\nmodeToPage[AppMode.COURSES] = CoursesPage;\n\n\nclass App extends React.Component {\n\n  constructor() {\n    super();\n    this.state = {mode: AppMode.LOGIN,\n                  menuOpen: false,\n                  authenticated: false,\n                  userObj: {displayName: \"\", profilePicURL: \"\"},\n                 };\n  }\n\n  //componentDidMount\n  componentDidMount() {\n    if (!this.state.authenticated) { \n      //Use /auth/test route to (re)-test authentication and obtain user data\n      fetch(\"/auth/test\")\n        .then((response) => response.json())\n        .then((obj) => {\n          if (obj.isAuthenticated) {\n            this.setState({\n              userObj: obj.user,\n              authenticated: true,\n              mode: AppMode.FEED //We're authenticated so can get into the app.\n            });\n          }\n        }\n      )\n    } \n  }\n\n  //refreshOnUpdate(newMode) -- Called by child components when user data changes in \n  //the database. The function calls the users/:userid (GET) route to update \n  //the userObj state var based on the latest database changes, and sets the \n  //mode state var is set to newMode. After this method is called, the\n  //App will re-render itself, forcing the new data to \n  //propagate to the child components when they are re-rendered.\n  refreshOnUpdate = async(newMode) => {\n    let response = await fetch(\"/users/\" + this.state.userObj.id);\n    response = await response.json();\n    const obj = JSON.parse(response);\n    this.setState({\n      userObj: obj,\n      mode: newMode\n    });\n  }\n\n\n  handleChangeMode = (newMode) => {\n    this.setState({mode: newMode});\n  }\n\n  openMenu = () => {\n    this.setState({menuOpen : true});\n  }\n  \n  closeMenu = () => {\n    this.setState({menuOpen : false});\n  }\n\n  toggleMenuOpen = () => {\n    this.setState(prevState => ({menuOpen: !prevState.menuOpen}));\n  }\n\n  setUserId = (Id) => {\n    this.setState({userId: Id,\n                   authenticated: true});\n  }\n\n\n  render() {\n    const ModePage = modeToPage[this.state.mode];\n    return (\n      <div>\n        <NavBar \n          title={modeTitle[this.state.mode]} \n          mode={this.state.mode}\n          changeMode={this.handleChangeMode}\n          menuOpen={this.state.menuOpen}\n          toggleMenuOpen={this.toggleMenuOpen}/>\n          <SideMenu \n            menuOpen = {this.state.menuOpen}\n            mode={this.state.mode}\n            toggleMenuOpen={this.toggleMenuOpen}\n            displayName={this.state.userObj.displayName}\n            profilePicURL={this.state.userObj.profilePicURL}\n            logOut={() => this.handleChangeMode(AppMode.LOGIN)}/>\n          <ModeBar \n            mode={this.state.mode} \n            changeMode={this.handleChangeMode}\n            menuOpen={this.state.menuOpen}/>\n          <ModePage \n            menuOpen={this.state.menuOpen}\n            mode={this.state.mode}\n            changeMode={this.handleChangeMode}\n            userObj={this.state.userObj}\n            refreshOnUpdate={this.refreshOnUpdate}/>\n      </div>\n    );  \n  }\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}